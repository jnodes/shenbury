<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ru Kiln Ceramics & Chinese Imperial Artifacts | Shenbury 神堡</title>
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Shenbury 神堡 - The Art of Provenance. Authenticated Ru kiln ceramics from Northern Song Dynasty. Museum-quality Chinese artifacts with ERC-404 fractional ownership.">
    <meta name="keywords" content="Shenbury, 神堡, Ru kiln, Ru ware, Song Dynasty, Chinese ceramics, 汝窯, 宋代瓷器, auction, ERC-404, NFT, provenance">
    
    <!-- Open Graph for Social -->
    <meta property="og:title" content="Shenbury 神堡 | $500M Chinese Imperial Ceramics Collection">
    <meta property="og:description" content="The Art of Provenance. Own fractional shares of museum-quality Ru kiln and imperial Chinese artifacts.">
    <meta property="og:image" content="/assets/images/relics/001-ru-kiln-washer/hero.jpg">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://shenbury.com">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shenbury 神堡 - Rare Ru Kiln Ceramics at Auction">
    <meta name="twitter:image" content="/assets/images/relics/001-ru-kiln-washer/hero.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="alternate icon" href="/favicon.ico">
    
    <!-- Structured Data for Google -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ArtGallery",
      "name": "Shenbury 神堡",
      "description": "The Art of Provenance - Web3 auction house for Chinese imperial ceramics",
      "url": "https://shenbury.com",
      "slogan": "The Art of Provenance",
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Imperial Chinese Ceramics",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "VisualArtwork",
              "name": "Ru Kiln Sunflower Washer",
              "creator": "Northern Song Dynasty",
              "dateCreated": "11th-12th Century",
              "material": "Ceramic with Ru glaze"
            },
            "price": "35000000",
            "priceCurrency": "USD"
          }
        ]
      }
    }
    </script>
    
    <link rel="canonical" href="https://shenbury.com">
    
    <!-- External Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #000000;
            --secondary: #ffffff;
            --accent: #c9302c;
            --gray-light: #f8f8f8;
            --gray-medium: #e5e5e5;
            --gray-dark: #666666;
            --text-primary: #000000;
            --text-secondary: #666666;
            --hover: #c9302c;
            --shadow: rgba(0, 0, 0, 0.08);
            --font-primary: 'Cormorant Garamond', serif;
            --font-secondary: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        
        body {
            font-family: var(--font-secondary);
            background: var(--secondary);
            color: var(--text-primary);
            line-height: 1.6;
            font-weight: 300;
        }
        
        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-primary);
            font-weight: 300;
            letter-spacing: -0.02em;
        }
        
        /* Loading State */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s ease;
        }
        
        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loader {
            width: 40px;
            height: 40px;
            border: 2px solid var(--gray-medium);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Header */
        header {
            background: var(--secondary);
            border-bottom: 1px solid var(--gray-medium);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 0 2rem;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 80px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            cursor: pointer;
        }
        
        .logo-text {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }
        
        .logo-chinese {
            font-family: var(--font-primary);
            font-size: 1.25rem;
            font-weight: 400;
        }
        
        .logo-english {
            font-family: var(--font-primary);
            font-size: 1.75rem;
            font-weight: 400;
            letter-spacing: 0.05em;
        }
        
        .logo-tagline {
            font-size: 0.625rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--text-secondary);
            margin-top: 0.25rem;
            font-family: var(--font-secondary);
        }
        
        .nav-center {
            display: flex;
            gap: 3rem;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .nav-center a {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            transition: color 0.3s ease;
            position: relative;
        }
        
        .nav-center a:hover {
            color: var(--hover);
        }
        
        .nav-center a.active::after {
            content: '';
            position: absolute;
            bottom: -29px;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--accent);
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        
        .wallet-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.875rem;
        }
        
        .erc404-balance {
            background: var(--gray-light);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .connect-wallet {
            background: var(--primary);
            color: var(--secondary);
            border: 1px solid var(--primary);
            padding: 0.75rem 2rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 400;
        }
        
        .connect-wallet:hover {
            background: transparent;
            color: var(--primary);
        }
        
        .connect-wallet.connected {
            background: transparent;
            color: var(--primary);
        }
        
        /* Hero Section */
        .hero {
            height: 500px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.6)),
                        linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            background-size: cover;
            background-position: center;
        }
        
        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-image: url('/assets/images/hero-bg.jpg');
            background-size: cover;
            background-position: center;
            filter: brightness(0.8);
        }
        
        .hero-content {
            text-align: center;
            color: white;
            max-width: 800px;
            padding: 0 2rem;
            animation: heroFadeIn 1s ease;
        }
        
        @keyframes heroFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 300;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            font-family: var(--font-primary);
        }
        
        .hero p {
            font-size: 1.25rem;
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 2rem;
            font-family: var(--font-secondary);
        }
        
        .hero-cta {
            background: var(--accent);
            color: white;
            border: none;
            padding: 1rem 3rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .hero-cta:hover {
            background: #a02622;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(201, 48, 44, 0.3);
        }
        
        /* Auction Header */
        .auction-header {
            max-width: 1400px;
            margin: 4rem auto 2rem;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }
        
        .auction-header h2 {
            font-size: 2rem;
            font-weight: 300;
            font-family: var(--font-primary);
        }
        
        .auction-stats {
            display: flex;
            gap: 3rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            color: var(--text-primary);
            display: block;
            font-weight: 400;
        }
        
        /* Filter Bar */
        .filter-bar {
            max-width: 1400px;
            margin: 0 auto 3rem;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--gray-medium);
            border-bottom: 1px solid var(--gray-medium);
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        
        .dynasty-filters {
            display: flex;
            gap: 2rem;
        }
        
        .dynasty-filter {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 0.5rem 0;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .dynasty-filter:hover,
        .dynasty-filter.active {
            color: var(--text-primary);
        }
        
        .dynasty-filter.active::after {
            content: '';
            position: absolute;
            bottom: -1rem;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--accent);
        }
        
        .sort-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            font-size: 0.875rem;
        }
        
        .sort-select {
            border: 1px solid var(--gray-medium);
            padding: 0.5rem 1rem;
            background: white;
            cursor: pointer;
            outline: none;
        }
        
        .sort-select:focus {
            border-color: var(--text-primary);
        }
        
        /* Artifact Grid */
        .artifacts-grid {
            max-width: 1400px;
            margin: 0 auto 4rem;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 3rem;
        }
        
        .artifact-card {
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            animation: cardFadeIn 0.5s ease forwards;
        }
        
        .artifact-card:nth-child(1) { animation-delay: 0.1s; }
        .artifact-card:nth-child(2) { animation-delay: 0.2s; }
        .artifact-card:nth-child(3) { animation-delay: 0.3s; }
        .artifact-card:nth-child(4) { animation-delay: 0.4s; }
        .artifact-card:nth-child(5) { animation-delay: 0.5s; }
        
        @keyframes cardFadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(20px);
            }
        }
        
        .artifact-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px var(--shadow);
        }
        
        .artifact-image-container {
            position: relative;
            background: var(--gray-light);
            overflow: hidden;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Dynamic aspect ratios */
        .artifact-image-container.portrait {
            padding-bottom: 133%; /* 3:4 ratio */
        }
        
        .artifact-image-container.landscape {
            padding-bottom: 75%; /* 4:3 ratio */
        }
        
        .artifact-image-container.square {
            padding-bottom: 100%; /* 1:1 ratio */
        }
        
        .artifact-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: #f8f8f8;
            transition: transform 0.5s ease;
        }
        
        /* Image loading states */
        .artifact-image.loading {
            opacity: 0;
        }
        
        .artifact-image.loaded {
            opacity: 1;
            animation: imageReveal 0.5s ease;
        }
        
        @keyframes imageReveal {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .artifact-card:hover .artifact-image {
            transform: scale(1.05);
        }
        
        .artifact-info {
            padding: 0 0.5rem;
        }
        
        .artifact-lot {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }
        
        .artifact-title {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            font-weight: 400;
            line-height: 1.4;
            font-family: var(--font-primary);
        }
        
        .artifact-dynasty {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .artifact-estimate {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }
        
        .artifact-bid {
            font-size: 1.125rem;
            font-weight: 400;
            margin-bottom: 0.5rem;
        }
        
        .artifact-erc404 {
            background: var(--gray-light);
            padding: 0.75rem;
            margin-top: 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            border-radius: 4px;
        }
        
        .artifact-erc404 strong {
            color: var(--text-primary);
            font-weight: 500;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            overflow-y: auto;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            max-width: 1200px;
            margin: 2rem auto;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .close-modal {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: white;
            border: none;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
            border-radius: 50%;
            box-shadow: 0 2px 10px var(--shadow);
        }
        
        .close-modal:hover {
            transform: rotate(90deg);
            background: var(--gray-light);
        }
        
        .modal-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-height: 600px;
        }
        
        .modal-image-section {
            background: var(--gray-light);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 2rem;
        }
        
        /* Image gallery dots */
        .image-gallery-dots {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
        }
        
        .gallery-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .gallery-dot.active {
            background: var(--accent);
            width: 24px;
            border-radius: 4px;
        }
        
        .modal-info-section {
            padding: 3rem;
            overflow-y: auto;
            max-height: 90vh;
        }
        
        .modal-lot-number {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
        }
        
        .modal-title {
            font-size: 2rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            line-height: 1.3;
            font-family: var(--font-primary);
        }
        
        .modal-dynasty {
            font-size: 1.125rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }
        
        .modal-description {
            font-size: 1rem;
            line-height: 1.8;
            margin-bottom: 2rem;
            color: var(--text-secondary);
        }
        
        .detail-sections {
            border-top: 1px solid var(--gray-medium);
            padding-top: 2rem;
            margin-bottom: 2rem;
        }
        
        .detail-section {
            margin-bottom: 1.5rem;
        }
        
        .detail-section h4 {
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
            font-weight: 400;
        }
        
        .detail-section p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.6;
        }
        
        .bidding-section {
            border-top: 1px solid var(--gray-medium);
            padding-top: 2rem;
        }
        
        .current-bid-info {
            margin-bottom: 2rem;
        }
        
        .current-bid-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        .current-bid-amount {
            font-size: 2rem;
            font-weight: 400;
            margin: 0.5rem 0;
            font-family: var(--font-primary);
        }
        
        .bid-count {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .bid-options {
            display: grid;
            gap: 2rem;
        }
        
        .bid-option {
            border: 1px solid var(--gray-medium);
            padding: 1.5rem;
            border-radius: 4px;
            transition: border-color 0.3s ease;
        }
        
        .bid-option:hover {
            border-color: var(--text-primary);
        }
        
        .bid-option h5 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            font-weight: 400;
        }
        
        .bid-option p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .bid-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .bid-input {
            flex: 1;
            border: 1px solid var(--gray-medium);
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border-radius: 4px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        .bid-input:focus {
            border-color: var(--text-primary);
        }
        
        .bid-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            border-radius: 4px;
        }
        
        .bid-button:hover {
            background: var(--hover);
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .bid-button:disabled {
            background: var(--gray-medium);
            cursor: not-allowed;
            transform: none;
        }
        
        .bid-button.secondary {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }
        
        .bid-button.secondary:hover {
            background: var(--primary);
            color: white;
        }
        
        .erc404-info {
            background: var(--gray-light);
            padding: 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            border-radius: 4px;
            line-height: 1.6;
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--primary);
            color: white;
            padding: 1rem 2rem;
            border-radius: 4px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 3000;
            max-width: 400px;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            background: #28a745;
        }
        
        .toast.error {
            background: #dc3545;
        }
        
        /* Footer */
        footer {
            background: var(--primary);
            color: white;
            padding: 3rem 2rem;
            margin-top: 6rem;
        }
        
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 3rem;
        }
        
        .footer-section h4 {
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            font-weight: 400;
            font-family: var(--font-secondary);
        }
        
        .footer-section a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 0.875rem;
            display: block;
            margin-bottom: 0.5rem;
            transition: color 0.3s ease;
        }
        
        .footer-section a:hover {
            color: white;
        }
        
        .footer-bottom {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .footer-logo {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .footer-logo .logo-text {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }
        
        .footer-logo .logo-chinese {
            font-family: var(--font-primary);
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .footer-logo .logo-english {
            font-family: var(--font-primary);
            font-size: 1.5rem;
            font-weight: 400;
            color: white;
        }
        
        /* Mobile Menu */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
        }
        
        .mobile-menu-toggle span {
            display: block;
            width: 25px;
            height: 2px;
            background: var(--primary);
            margin: 5px 0;
            transition: all 0.3s ease;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .nav-center {
                display: none;
            }
            
            .mobile-menu-toggle {
                display: block;
            }
            
            .modal-body {
                grid-template-columns: 1fr;
            }
            
            .modal-image-section {
                height: 400px;
            }
            
            .artifacts-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 2rem;
            }
        }
        
        @media (max-width: 768px) {
            .logo-text {
                gap: 0.25rem;
            }
            
            .logo-chinese {
                font-size: 1rem;
            }
            
            .logo-english {
                font-size: 1.25rem;
            }
            
            .logo-tagline {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .hero p {
                font-size: 1.125rem;
            }
            
            .artifacts-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .footer-logo {
                align-items: center;
            }
            
            .auction-header {
                flex-direction: column;
                gap: 2rem;
                text-align: center;
            }
            
            .filter-bar {
                flex-direction: column;
                gap: 1rem;
            }
            
            .dynasty-filters {
                overflow-x: auto;
                width: 100%;
                justify-content: flex-start;
                padding-bottom: 0.5rem;
            }
            
            .modal-info-section {
                padding: 2rem;
            }
            
            .toast {
                left: 1rem;
                right: 1rem;
                bottom: 1rem;
            }
        }
        
        /* Progressive Image Loading */
        .progressive-image {
            position: relative;
            overflow: hidden;
            background: var(--gray-light);
        }
        
        .progressive-image img {
            display: block;
            width: 100%;
            height: auto;
            transition: opacity 0.3s ease;
        }
        
        .progressive-image .placeholder {
            filter: blur(20px);
            transform: scale(1.1);
        }
        
        .progressive-image .full-image {
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
        }
        
        .progressive-image .full-image.loaded {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading" id="loading">
        <div class="loader"></div>
    </div>

    <header>
        <nav>
            <div class="logo" onclick="scrollToTop()">
                <div class="logo-text">
                    <div class="logo-chinese">神堡</div>
                    <div class="logo-english">Shenbury</div>
                </div>
                <div class="logo-tagline">The Art of Provenance</div>
            </div>
            <div class="nav-center">
                <a href="#auctions" class="active">Auctions</a>
                <a href="#private">Private Sales</a>
                <a href="#exhibitions">Exhibitions</a>
                <a href="#about">About</a>
            </div>
            <div class="nav-right">
                <div class="wallet-info">
                    <div class="erc404-balance" id="token-balance">
                        <span id="balance-amount">0</span> SHEN
                    </div>
                    <button class="connect-wallet" onclick="connectWallet()">
                        <span id="wallet-text">Connect Wallet</span>
                    </button>
                </div>
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </nav>
    </header>

    <section class="hero">
        <div class="hero-background"></div>
        <div class="hero-content">
            <h1>Exceptional Chinese Art</h1>
            <p>Qing, Ming, Song & Yuan Dynasty Masterpieces</p>
            <button class="hero-cta" onclick="scrollToAuctions()">View Current Auctions</button>
        </div>
    </section>

    <div class="auction-header" id="auctions">
        <h2>Featured Lots</h2>
        <div class="auction-stats">
            <div class="stat-item">
                <span class="stat-value" id="total-lots">0</span>
                <span>Total Lots</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="total-bids">0</span>
                <span>Active Bids</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="total-value">0</span>
                <span>Total Value (ETH)</span>
            </div>
        </div>
    </div>

    <div class="filter-bar">
        <div class="dynasty-filters">
            <button class="dynasty-filter active" onclick="filterByDynasty('all')">All Dynasties</button>
            <button class="dynasty-filter" onclick="filterByDynasty('qing')">Qing Dynasty</button>
            <button class="dynasty-filter" onclick="filterByDynasty('ming')">Ming Dynasty</button>
            <button class="dynasty-filter" onclick="filterByDynasty('song')">Song Dynasty</button>
            <button class="dynasty-filter" onclick="filterByDynasty('yuan')">Yuan Dynasty</button>
        </div>
        <div class="sort-controls">
            <span>Sort by:</span>
            <select class="sort-select" onchange="sortArtifacts(this.value)">
                <option value="lot">Lot Number</option>
                <option value="price-high">Price: High to Low</option>
                <option value="price-low">Price: Low to High</option>
                <option value="ending">Ending Soon</option>
            </select>
        </div>
    </div>

    <div class="artifacts-grid" id="artifacts-grid">
        <!-- Artifact cards will be dynamically generated -->
    </div>

    <!-- Artifact Detail Modal -->
    <div class="modal" id="artifact-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">&times;</button>
            <div class="modal-body">
                <div class="modal-image-section">
                    <img src="" alt="" class="modal-image" id="modal-image">
                    <div class="image-gallery-dots" id="gallery-dots"></div>
                </div>
                <div class="modal-info-section">
                    <div class="modal-lot-number" id="modal-lot">LOT 000</div>
                    <h2 class="modal-title" id="modal-title"></h2>
                    <p class="modal-dynasty" id="modal-dynasty"></p>
                    <p class="modal-description" id="modal-description"></p>
                    
                    <div class="detail-sections">
                        <div class="detail-section">
                            <h4>Provenance</h4>
                            <p id="modal-provenance"></p>
                        </div>
                        <div class="detail-section">
                            <h4>Condition</h4>
                            <p id="modal-condition"></p>
                        </div>
                        <div class="detail-section">
                            <h4>Dimensions</h4>
                            <p id="modal-dimensions"></p>
                        </div>
                        <div class="detail-section">
                            <h4>Literature</h4>
                            <p id="modal-literature"></p>
                        </div>
                        <div class="detail-section" id="technical-notes-section" style="display: none;">
                            <h4>Technical Notes</h4>
                            <p id="modal-technical-notes"></p>
                        </div>
                        <div class="detail-section" id="cultural-significance-section" style="display: none;">
                            <h4>Cultural Significance</h4>
                            <p id="modal-cultural-significance"></p>
                        </div>
                    </div>
                    
                    <div class="bidding-section">
                        <div class="current-bid-info">
                            <div class="current-bid-label">Current Bid</div>
                            <div class="current-bid-amount" id="modal-current-bid">0.00 ETH</div>
                            <div class="bid-count" id="modal-bid-count">0 bids</div>
                        </div>
                        
                        <div class="bid-options">
                            <div class="bid-option">
                                <h5>Place Bid for Full Ownership</h5>
                                <p>Acquire complete ownership of this artifact as an NFT</p>
                                <div class="bid-input-group">
                                    <input type="number" class="bid-input" id="bid-amount" placeholder="Amount in ETH" step="0.1" min="0">
                                    <button class="bid-button" onclick="placeBid()">Place Bid</button>
                                </div>
                                <p style="font-size: 0.75rem; margin-top: 0.5rem;">Minimum bid: <span id="min-bid">0.00</span> ETH</p>
                            </div>
                            
                            <div class="bid-option">
                                <h5>Buy Fractional Ownership (ERC-404)</h5>
                                <p>Purchase SHEN tokens for partial ownership. 10,000 SHEN = 1 full NFT</p>
                                <div class="bid-input-group">
                                    <input type="number" class="bid-input" id="token-amount" placeholder="Number of SHEN tokens" step="100" min="100">
                                    <button class="bid-button secondary" onclick="buyTokens()">Buy Tokens</button>
                                </div>
                                <div class="erc404-info">
                                    <strong>Current Price:</strong> 0.0001 ETH per SHEN<br>
                                    <strong>Available:</strong> <span id="available-tokens">8,500</span> SHEN for this artifact<br>
                                    <strong>Your Holdings:</strong> <span id="user-artifact-tokens">0</span> SHEN
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <div class="footer-logo">
                    <div class="logo-text">
                        <div class="logo-chinese">神堡</div>
                        <div class="logo-english">Shenbury</div>
                    </div>
                    <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.875rem; margin-top: 0.5rem;">The Art of Provenance</p>
                </div>
            </div>
            <div class="footer-section">
                <h4>Services</h4>
                <a href="#">Auctions</a>
                <a href="#">Private Sales</a>
                <a href="#">Valuations</a>
                <a href="#">ERC-404 Guide</a>
            </div>
            <div class="footer-section">
                <h4>About</h4>
                <a href="#">Our Specialists</a>
                <a href="#">Press</a>
                <a href="#">Careers</a>
                <a href="#">Contact</a>
            </div>
            <div class="footer-section">
                <h4>Technology</h4>
                <a href="#">Smart Contracts</a>
                <a href="#">IPFS Storage</a>
                <a href="#">Token Economics</a>
                <a href="#">Security Audits</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Shenbury 神堡. All rights reserved. | The Art of Provenance | ERC-404 Powered by Ethereum</p>
        </div>
    </footer>

    <script>
        // Enhanced artifact data with image paths for your new files
        const artifacts = [
            {
                id: 1,
                lotNumber: '001',
                title: 'AN EXCEPTIONALLY RARE RU KILN SUNFLOWER-FORM WASHER',
                chinese: '北宋 汝官窯天青釉葵花洗',
                dynasty: 'song',
                dynastyInfo: 'Northern Song Dynasty, 11th-12th Century',
                imageOrientation: 'landscape',
                images: [
                    '/assets/images/relics/001-song-ru-washer/main.jpg',
                    '/assets/images/relics/001-song-ru-washer/detail-1.jpg',
                    '/assets/images/relics/001-song-ru-washer/detail-2.jpg',
                    '/assets/images/relics/001-song-ru-washer/detail-3.jpg'
                ],
                thumbnail: '/assets/images/relics/001-song-ru-washer/thumbnail.jpg',
                placeholder: '/assets/images/relics/001-song-ru-washer/placeholder.jpg',
                description: 'This extraordinarily rare washer represents the pinnacle of Song ceramic achievement. Ru ware was produced for a mere twenty years at the end of the Northern Song period, exclusively for imperial use. The distinctive sky-blue glaze with its subtle crackle pattern was considered the finest of all Chinese ceramics.',
                estimate: { low: 5000, high: 8000 },
                currentBid: 6000,
                bidCount: 47,
                endTime: Date.now() + 86400000 * 7,
                provenance: 'Private Collection, Hong Kong\nFormed in the 1970s\nAcquired from J.J. Lally & Co., New York, 1985',
                condition: 'Excellent condition with characteristic ice-crackle throughout the glaze. Minor expected wear to the foot ring consistent with age.',
                dimensions: 'Diameter: 14.6 cm\nHeight: 3.65 cm\nWeight: 285g',
                literature: 'Compare a similar example in the Palace Museum, Beijing, illustrated in "Complete Collection of Treasures of the Palace Museum: Porcelain of the Song Dynasty (I)", Hong Kong, 1996, pl. 5',
                technicalNotes: 'The glaze exhibits the characteristic "sky-blue" color achieved through reduction firing. X-ray fluorescence analysis confirms the presence of agate powder in the glaze composition, a hallmark of authentic Ru ware.',
                culturalSignificance: 'Ru kilns operated for only about 20 years (1086-1106) exclusively for the Northern Song court. Fewer than 100 genuine pieces are known to exist worldwide.',
                fractionalAvailable: 1000,
                tokenHolders: 125
            },
            {
                id: 2,
                lotNumber: '002',
                title: 'AN IMPERIAL RU KILN "SKY BLUE" GOURD BOTTLE',
                chinese: '北宋 汝窯天青釉葫蘆瓶',
                dynasty: 'song',
                dynastyInfo: 'Northern Song Dynasty, 11th-12th Century',
                imageOrientation: 'portrait',
                images: [
                    '/assets/images/relics/002-song-ru-bottle/main.jpg',
                    '/assets/images/relics/002-song-ru-bottle/detail-1.jpg',
                    '/assets/images/relics/002-song-ru-bottle/detail-2.jpg'
                ],
                thumbnail: '/assets/images/relics/002-song-ru-bottle/thumbnail.jpg',
                placeholder: '/assets/images/relics/002-song-ru-bottle/placeholder.jpg',
                description: 'This magnificent gourd-form bottle exemplifies the restraint and elegance that characterizes the finest Ru ware. The form, derived from natural gourds used as water containers, was transformed by Song potters into an object of sublime beauty.',
                estimate: { low: 6000, high: 10000 },
                currentBid: 7500,
                bidCount: 62,
                endTime: Date.now() + 86400000 * 10,
                provenance: 'Private Collection, Taiwan\nFormerly in the collection of Sakamoto Gorō (1923-2016)\nAcquired at Sotheby\'s Hong Kong, April 2005',
                condition: 'Perfect condition. The glaze is of exceptional quality with the desirable "ice crackle" pattern throughout.',
                dimensions: 'Height: 22.8 cm\nDiameter: 12.5 cm\nWeight: 680g',
                literature: 'For a closely related example, see the gourd vase in the British Museum, London, published in Jessica Harrison-Hall, "Catalogue of Late Yuan and Ming Ceramics in the British Museum", London, 2001, no. 15:1',
                technicalNotes: 'Thermoluminescence test certificate from Oxford Authentication Ltd. confirms dating to 900 ± 100 years.',
                fractionalAvailable: 500,
                tokenHolders: 198
            },
            {
                id: 3,
                lotNumber: '003',
                title: 'A MAGNIFICENT MING XUANDE CLOISONNÉ TRIPOD CENSER',
                chinese: '明宣德 掐絲琺瑯獸鈕蓮紋三足爐',
                dynasty: 'ming',
                dynastyInfo: 'Xuande Period (1426-1435)',
                imageOrientation: 'square',
                images: [
                    '/assets/images/relics/003-ming-cloisonne/main.jpg',
                    '/assets/images/relics/003-ming-cloisonne/detail-1.jpg',
                    '/assets/images/relics/003-ming-cloisonne/detail-2.jpg',
                    '/assets/images/relics/003-ming-cloisonne/mark.jpg'
                ],
                thumbnail: '/assets/images/relics/003-ming-cloisonne/thumbnail.jpg',
                placeholder: '/assets/images/relics/003-ming-cloisonne/placeholder.jpg',
                description: 'This exceptional censer represents the golden age of Chinese cloisonné production during the Xuande period. The technique, introduced from Byzantium via the Silk Road, reached its artistic zenith under imperial patronage.',
                estimate: { low: 120, high: 180 },
                currentBid: 150,
                bidCount: 38,
                endTime: Date.now() + 86400000 * 6,
                provenance: 'Private Collection, Hong Kong\nFormerly from the Qing Court Collection\nChristie\'s London, November 1989, lot 234',
                condition: 'Excellent condition. Minor restoration to one cloud-scroll on the rim professionally executed.',
                dimensions: 'Height: 28.5 cm\nWidth: 35.2 cm\nWeight: 4.2 kg',
                literature: 'Illustrated in Harry Garner, "Chinese and Japanese Cloisonné Enamels", London, 1962, pl. 48A',
                culturalSignificance: 'Xuande marked cloisonné pieces are among the rarest and most sought-after works of Chinese decorative arts. This example bears the imperial six-character mark.',
                fractionalAvailable: 4000,
                tokenHolders: 76
            },
         // In your index.html, find the lot 004 object and replace it with this:
{
    id: 4,
    lotNumber: '004',
    title: 'AN EXTRAORDINARILY RARE YUAN JILAN-GLAZED EWER',
    chinese: '元 霽藍釉白龍紋梨形執壺',
    dynasty: 'yuan',
    dynastyInfo: 'Yuan Dynasty (1271-1368)',
    imageOrientation: 'portrait',
    images: [
        'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/main.jpg',
        'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/detail-1.jpg',
        'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/detail-2.jpg',
        'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/detail-3.jpg',
        'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/detail-4.jpg'
    ],
    thumbnail: 'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/main.jpg',
    placeholder: 'https://raw.githubusercontent.com/jnodes/shenbury/main/public/assets/images/relics/004-yuan-jilan-ewer/main.jpg',
    description: 'This spectacular ewer showcases the technical mastery achieved by Yuan potters in high-fired cobalt blue glazes. The dramatic contrast between the deep blue ground and white slip-painted dragon demonstrates the sophisticated decorative techniques of the period.',
    estimate: { low: 250, high: 400 },
    currentBid: 325,
    bidCount: 41,
    endTime: Date.now() + 86400000 * 8,
    provenance: 'Private Japanese Collection, Kyoto\nFormerly in the Idemitsu Museum of Arts\nAcquired from Yamanaka & Co., Kyoto, 1955',
    condition: 'Remarkable condition. Small chip to the spout professionally restored. The cobalt blue glaze of exceptional depth and brilliance.',
    dimensions: 'Height: 31.3 cm\nWidth: 18.5 cm\nWeight: 1.45 kg',
    literature: 'Published in "Yuan Blue and White Porcelain", National Palace Museum, Taipei, 1998, no. 47',
    technicalNotes: 'The cobalt used in this piece has been identified through spectrographic analysis as imported Persian cobalt, confirming its imperial quality.',
    culturalSignificance: 'Yuan dynasty blue and white represents a revolutionary moment in ceramic history, combining Chinese potting techniques with Islamic aesthetic preferences.',
    fractionalAvailable: 3000,
    tokenHolders: 92
}
            {
                id: 5,
                lotNumber: '005',
                title: 'A RARE IMPERIAL QING YANGCAI "BUTTERFLY" VASE',
                chinese: '清乾隆 洋彩蝴蝶紋瓶',
                dynasty: 'qing',
                dynastyInfo: 'Qianlong Period (1736-1795)',
                imageOrientation: 'portrait',
                images: [
                    '/assets/images/relics/005-qing-butterfly-vase/main.jpg',
                    '/assets/images/relics/005-qing-butterfly-vase/detail-1.jpg',
                    '/assets/images/relics/005-qing-butterfly-vase/detail-2.jpg',
                    '/assets/images/relics/005-qing-butterfly-vase/mark.jpg'
                ],
                thumbnail: '/assets/images/relics/005-qing-butterfly-vase/thumbnail.jpg',
                placeholder: '/assets/images/relics/005-qing-butterfly-vase/placeholder.jpg',
                description: 'The ovoid body rising from a spreading foot to a waisted neck with a flared rim, brilliantly enamelled with butterflies in flight amidst flowering branches. This piece exemplifies the technical perfection achieved at the imperial kilns during the Qianlong period.',
                estimate: { low: 80, high: 120 },
                currentBid: 95,
                bidCount: 12,
                endTime: Date.now() + 86400000 * 3,
                provenance: 'Private European Collection, acquired 1960s\nFormerly in the collection of Baron von H., Switzerland',
                condition: 'Excellent condition with minor wear to the gilding on the rim, consistent with age.',
                dimensions: 'Height: 38.5 cm\nDiameter: 19.2 cm',
                literature: 'Compare a similar example in the Palace Museum, Beijing, illustrated in "The Complete Collection of Treasures of the Palace Museum: Porcelains with Cloisonné Enamel Decoration", vol. 39, Hong Kong, 2009, pl. 165',
                fractionalAvailable: 8500,
                tokenHolders: 15
            }
        ];
        
        // Web3 Configuration
        let web3;
        let userAccount;
        let auctionContract;
        let erc404Contract;
        
        // ERC-404 Contract ABI (simplified)
        const ERC404_CONTRACT_ABI = [
            {
                "inputs": [],
                "name": "name",
                "outputs": [{"name": "", "type": "string"}],
                "type": "function"
            },
            {
                "inputs": [{"name": "owner", "type": "address"}],
                "name": "balanceOf",
                "outputs": [{"name": "", "type": "uint256"}],
                "type": "function"
            },
            {
                "inputs": [{"name": "to", "type": "address"}, {"name": "amount", "type": "uint256"}],
                "name": "transfer",
                "outputs": [{"name": "", "type": "bool"}],
                "type": "function"
            }
        ];
        
        // Add these fixes to your index.html after the artifacts array

// Fix 1: Update contract addresses (add after the contract address constants)
const AUCTION_CONTRACT_ADDRESS = "0x1234567890123456789012345678901234567890"; // TODO: Replace after deployment
const ERC404_CONTRACT_ADDRESS = "0x0987654321098765432109876543210987654321"; // TODO: Replace after deployment

// Fix 2: Enhance error handling for Web3 operations
async function connectWallet() {
    if (typeof window.ethereum !== 'undefined') {
        try {
            // Request account access
            const accounts = await window.ethereum.request({ 
                method: 'eth_requestAccounts' 
            });
            userAccount = accounts[0];
            
            // Initialize Web3
            web3 = new Web3(window.ethereum);
            
            // Check network
            const networkId = await web3.eth.getChainId();
            console.log('Connected to network:', networkId);
            
            // Initialize contracts with error handling
            try {
                erc404Contract = new web3.eth.Contract(
                    ERC404_CONTRACT_ABI, 
                    ERC404_CONTRACT_ADDRESS
                );
                console.log('Contracts initialized');
            } catch (contractError) {
                console.log('Contracts pending deployment');
                // Continue in demo mode
            }
            
            updateWalletUI();
            showToast('Wallet connected successfully!', 'success');
            
        } catch (error) {
            console.error('Error connecting wallet:', error);
            if (error.code === 4001) {
                showToast('Connection cancelled', 'error');
            } else if (error.code === -32002) {
                showToast('Please unlock MetaMask', 'error');
            } else {
                showToast('Failed to connect wallet', 'error');
            }
        }
    } else {
        showToast('Please install MetaMask to use this dApp', 'error');
        window.open('https://metamask.io/download/', '_blank');
    }
}

// Fix 3: Add demo mode for testing without contracts
const DEMO_MODE = !window.ethereum || !AUCTION_CONTRACT_ADDRESS.startsWith('0x') || AUCTION_CONTRACT_ADDRESS === "0x1234567890123456789012345678901234567890";

async function placeBid() {
    if (!userAccount) {
        showToast('Please connect your wallet first', 'error');
        return;
    }
    
    const bidInput = document.getElementById('bid-amount');
    const bidAmount = parseFloat(bidInput.value);
    const minBid = selectedArtifact.currentBid + 5;
    
    if (isNaN(bidAmount) || bidAmount < minBid) {
        showToast(`Minimum bid is ${minBid} ETH`, 'error');
        return;
    }
    
    // Disable button during transaction
    const bidButton = event.target;
    bidButton.disabled = true;
    bidButton.textContent = 'Processing...';
    
    try {
        if (DEMO_MODE) {
            // Demo mode simulation
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            selectedArtifact.currentBid = bidAmount;
            selectedArtifact.bidCount++;
            
            showToast(`Demo Mode: Bid of ${bidAmount} ETH placed successfully!`, 'success');
            
            // Update modal
            document.getElementById('modal-current-bid').textContent = `${bidAmount} ETH`;
            document.getElementById('modal-bid-count').textContent = `${selectedArtifact.bidCount} bids`;
            
            // Update grid after modal closes
            setTimeout(() => {
                renderArtifacts();
                updateStats();
            }, 500);
            
            bidInput.value = '';
            
        } else {
            // Real contract interaction
            const tx = await auctionContract.methods.placeBid(selectedArtifact.id)
                .send({ 
                    from: userAccount, 
                    value: web3.utils.toWei(bidAmount.toString(), 'ether'),
                    gas: 200000
                });
            
            showToast(`Bid placed! Transaction: ${tx.transactionHash.slice(0, 10)}...`, 'success');
            
            // Update UI after blockchain confirmation
            selectedArtifact.currentBid = bidAmount;
            selectedArtifact.bidCount++;
            renderArtifacts();
            updateStats();
        }
        
    } catch (error) {
        console.error('Error placing bid:', error);
        showToast(error.message || 'Failed to place bid', 'error');
    } finally {
        bidButton.disabled = false;
        bidButton.textContent = 'Place Bid';
    }
}

async function buyTokens() {
    if (!userAccount) {
        showToast('Please connect your wallet first', 'error');
        return;
    }
    
    const tokenInput = document.getElementById('token-amount');
    const tokenAmount = parseInt(tokenInput.value);
    
    if (isNaN(tokenAmount) || tokenAmount <= 0) {
        showToast('Please enter a valid token amount', 'error');
        return;
    }
    
    if (tokenAmount > selectedArtifact.fractionalAvailable) {
        showToast('Not enough tokens available', 'error');
        return;
    }
    
    const totalCost = tokenAmount * 0.0001;
    const buyButton = event.target;
    buyButton.disabled = true;
    buyButton.textContent = 'Processing...';
    
    try {
        if (DEMO_MODE) {
            // Demo mode simulation
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            selectedArtifact.fractionalAvailable -= tokenAmount;
            selectedArtifact.tokenHolders++;
            
            showToast(`Demo Mode: Purchased ${tokenAmount} SHEN tokens for ${totalCost} ETH!`, 'success');
            
            if (tokenAmount >= 10000) {
                showToast('Congratulations! You now own enough tokens for a full NFT!', 'success');
            }
            
            document.getElementById('available-tokens').textContent = 
                selectedArtifact.fractionalAvailable.toLocaleString();
            
            tokenInput.value = '';
            
        } else {
            // Real contract interaction
            const tx = await erc404Contract.methods.buyTokens(selectedArtifact.id, tokenAmount)
                .send({ 
                    from: userAccount, 
                    value: web3.utils.toWei(totalCost.toString(), 'ether'),
                    gas: 300000
                });
            
            showToast(`Tokens purchased! Transaction: ${tx.transactionHash.slice(0, 10)}...`, 'success');
            
            selectedArtifact.fractionalAvailable -= tokenAmount;
            selectedArtifact.tokenHolders++;
            
            await updateTokenBalance();
        }
        
        renderArtifacts();
        
    } catch (error) {
        console.error('Error buying tokens:', error);
        showToast(error.message || 'Failed to purchase tokens', 'error');
    } finally {
        buyButton.disabled = false;
        buyButton.textContent = 'Buy Tokens';
    }
}

// Fix 4: Add network detection and switching
async function checkNetwork() {
    if (!web3) return;
    
    const targetNetwork = '11155111'; // Sepolia testnet
    const currentNetwork = await web3.eth.getChainId();
    
    if (currentNetwork.toString() !== targetNetwork && !DEMO_MODE) {
        showToast('Please switch to Sepolia testnet', 'warning');
        
        try {
            await window.ethereum.request({
                method: 'wallet_switchEthereumChain',
                params: [{ chainId: '0x' + parseInt(targetNetwork).toString(16) }],
            });
        } catch (error) {
            if (error.code === 4902) {
                // Chain not added, add it
                await window.ethereum.request({
                    method: 'wallet_addEthereumChain',
                    params: [{
                        chainId: '0x' + parseInt(targetNetwork).toString(16),
                        chainName: 'Sepolia Testnet',
                        nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
                        rpcUrls: ['https://sepolia.infura.io/v3/'],
                        blockExplorerUrls: ['https://sepolia.etherscan.io/']
                    }]
                });
            }
        }
    }
}

// Fix 5: Update initialization to show demo mode
async function init() {
    hideLoading();
    renderArtifacts();
    updateStats();
    startTimers();
    
    // Check if Web3 is available
    if (typeof window.ethereum !== 'undefined') {
        web3 = new Web3(window.ethereum);
        
        // Check if already connected
        const accounts = await web3.eth.getAccounts();
        if (accounts.length > 0) {
            userAccount = accounts[0];
            await updateWalletUI();
            await checkNetwork();
        }
        
        // Listen for account changes
        window.ethereum.on('accountsChanged', handleAccountsChanged);
        window.ethereum.on('chainChanged', () => window.location.reload());
    }
    
    // Show demo mode notification
    if (DEMO_MODE) {
        setTimeout(() => {
            showToast('Running in Demo Mode - Connect wallet and deploy contracts for real transactions', 'info');
        }, 2000);
    }
}

// Fix 6: Better error messages
function showToast(message, type = 'info') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = `toast ${type}`;
    toast.classList.add('show');
    
    // Auto-hide after 4 seconds (longer for important messages)
    setTimeout(() => {
        toast.classList.remove('show');
    }, type === 'error' ? 5000 : 4000);
}
        
        // State variables
        let currentFilter = 'all';
        let currentSort = 'lot';
        let selectedArtifact = null;
        let currentImageIndex = 0;
        
        // Image loading with fallback
        function loadImage(img, src, fallbackSrc) {
            const tempImg = new Image();
            tempImg.onload = function() {
                img.src = src;
                img.classList.add('loaded');
            };
            tempImg.onerror = function() {
                if (fallbackSrc) {
                    img.src = fallbackSrc;
                }
            };
            tempImg.src = src;
        }
        
        // Progressive image loading
        function loadProgressiveImage(container, lowResSrc, highResSrc) {
            const lowResImg = new Image();
            const highResImg = new Image();
            
            lowResImg.src = lowResSrc;
            lowResImg.classList.add('placeholder');
            container.appendChild(lowResImg);
            
            highResImg.src = highResSrc;
            highResImg.classList.add('full-image');
            highResImg.onload = function() {
                highResImg.classList.add('loaded');
                setTimeout(() => {
                    lowResImg.remove();
                }, 300);
            };
            container.appendChild(highResImg);
        }
        
        // Initialize
        async function init() {
            hideLoading();
            renderArtifacts();
            updateStats();
            startTimers();
            
            // Check if Web3 is available
            if (typeof window.ethereum !== 'undefined') {
                web3 = new Web3(window.ethereum);
                
                // Check if already connected
                const accounts = await web3.eth.getAccounts();
                if (accounts.length > 0) {
                    userAccount = accounts[0];
                    updateWalletUI();
                }
                
                // Listen for account changes
                window.ethereum.on('accountsChanged', handleAccountsChanged);
            }
        }
        
        // Hide loading screen
        function hideLoading() {
            setTimeout(() => {
                document.getElementById('loading').classList.add('hidden');
            }, 500);
        }
        
        // Connect wallet
        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ 
                        method: 'eth_requestAccounts' 
                    });
                    userAccount = accounts[0];
                    
                    web3 = new Web3(window.ethereum);
                    
                    // Initialize contracts
                    erc404Contract = new web3.eth.Contract(
                        ERC404_CONTRACT_ABI, 
                        ERC404_CONTRACT_ADDRESS
                    );
                    
                    updateWalletUI();
                    showToast('Wallet connected successfully!', 'success');
                    
                } catch (error) {
                    console.error('Error connecting wallet:', error);
                    showToast('Failed to connect wallet', 'error');
                }
            } else {
                showToast('Please install MetaMask to use this dApp', 'error');
                window.open('https://metamask.io/download/', '_blank');
            }
        }
        
        // Handle account changes
        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                userAccount = null;
                updateWalletUI();
                showToast('Wallet disconnected', 'error');
            } else if (accounts[0] !== userAccount) {
                userAccount = accounts[0];
                updateWalletUI();
                showToast('Account changed', 'success');
            }
        }
        
        // Update wallet UI
        async function updateWalletUI() {
            const walletButton = document.querySelector('.connect-wallet');
            const balanceDisplay = document.getElementById('token-balance');
            
            if (userAccount) {
                walletButton.classList.add('connected');
                document.getElementById('wallet-text').textContent = 
                    `${userAccount.slice(0, 6)}...${userAccount.slice(-4)}`;
                
                balanceDisplay.style.display = 'block';
                await updateTokenBalance();
            } else {
                walletButton.classList.remove('connected');
                document.getElementById('wallet-text').textContent = 'Connect Wallet';
                balanceDisplay.style.display = 'none';
            }
        }
        
        // Update token balance
        async function updateTokenBalance() {
            if (!userAccount || !erc404Contract) return;
            
            try {
                // In production, this would call the contract
                // const balance = await erc404Contract.methods.balanceOf(userAccount).call();
                const balance = Math.floor(Math.random() * 5000); // Demo value
                document.getElementById('balance-amount').textContent = balance.toLocaleString();
            } catch (error) {
                console.error('Error fetching balance:', error);
            }
        }
        
        // Render artifacts with optimized images
        function renderArtifacts() {
            const grid = document.getElementById('artifacts-grid');
            let filteredArtifacts = artifacts;
            
            // Apply filter
            if (currentFilter !== 'all') {
                filteredArtifacts = artifacts.filter(a => a.dynasty === currentFilter);
            }
            
            // Apply sort
            filteredArtifacts.sort((a, b) => {
                switch(currentSort) {
                    case 'price-high':
                        return b.currentBid - a.currentBid;
                    case 'price-low':
                        return a.currentBid - b.currentBid;
                    case 'ending':
                        return a.endTime - b.endTime;
                    default:
                        return a.lotNumber.localeCompare(b.lotNumber);
                }
            });
            
            grid.innerHTML = filteredArtifacts.map(artifact => {
                const imageSrc = artifact.thumbnail || artifact.images[0] || '/assets/images/placeholder.jpg';
                return `
                    <div class="artifact-card" onclick="openArtifactModal(${artifact.id})">
                        <div class="artifact-image-container ${artifact.imageOrientation || 'square'}">
                            <img src="${imageSrc}" 
                                 alt="${artifact.title}" 
                                 class="artifact-image loading" 
                                 loading="lazy"
                                 onload="this.classList.remove('loading'); this.classList.add('loaded');"
                                 onerror="this.src='/assets/images/placeholder.jpg'">
                        </div>
                        <div class="artifact-info">
                            <div class="artifact-lot">LOT ${artifact.lotNumber}</div>
                            <h3 class="artifact-title">${artifact.title}</h3>
                            <p class="artifact-dynasty">${artifact.chinese}<br>${artifact.dynastyInfo}</p>
                            <p class="artifact-estimate">Estimate: ${artifact.estimate.low}-${artifact.estimate.high} ETH</p>
                            <p class="artifact-bid">${artifact.currentBid} ETH</p>
                            <p class="artifact-estimate">${artifact.bidCount} bids • ${getTimeLeft(artifact.endTime)}</p>
                            <div class="artifact-erc404">
                                <strong>ERC-404:</strong> ${artifact.fractionalAvailable.toLocaleString()} SHEN available<br>
                                ${artifact.tokenHolders} fractional owners
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // Filter by dynasty
        function filterByDynasty(dynasty) {
            currentFilter = dynasty;
            document.querySelectorAll('.dynasty-filter').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            renderArtifacts();
        }
        
        // Sort artifacts
        function sortArtifacts(sortBy) {
            currentSort = sortBy;
            renderArtifacts();
        }
        
        // Open artifact modal with image gallery
        function openArtifactModal(id) {
            selectedArtifact = artifacts.find(a => a.id === id);
            if (!selectedArtifact) return;
            
            currentImageIndex = 0;
            
            // Update modal content
            updateModalImage();
            document.getElementById('modal-lot').textContent = `LOT ${selectedArtifact.lotNumber}`;
            document.getElementById('modal-title').textContent = selectedArtifact.title;
            document.getElementById('modal-dynasty').textContent = `${selectedArtifact.chinese} | ${selectedArtifact.dynastyInfo}`;
            document.getElementById('modal-description').textContent = selectedArtifact.description;
            document.getElementById('modal-provenance').textContent = selectedArtifact.provenance;
            document.getElementById('modal-condition').textContent = selectedArtifact.condition;
            document.getElementById('modal-dimensions').textContent = selectedArtifact.dimensions;
            document.getElementById('modal-literature').textContent = selectedArtifact.literature;
            document.getElementById('modal-current-bid').textContent = `${selectedArtifact.currentBid} ETH`;
            document.getElementById('modal-bid-count').textContent = `${selectedArtifact.bidCount} bids`;
            document.getElementById('min-bid').textContent = (selectedArtifact.currentBid + 5).toFixed(2);
            document.getElementById('available-tokens').textContent = selectedArtifact.fractionalAvailable.toLocaleString();
            
            // Show technical notes and cultural significance if available
            if (selectedArtifact.technicalNotes) {
                document.getElementById('technical-notes-section').style.display = 'block';
                document.getElementById('modal-technical-notes').textContent = selectedArtifact.technicalNotes;
            } else {
                document.getElementById('technical-notes-section').style.display = 'none';
            }
            
            if (selectedArtifact.culturalSignificance) {
                document.getElementById('cultural-significance-section').style.display = 'block';
                document.getElementById('modal-cultural-significance').textContent = selectedArtifact.culturalSignificance;
            } else {
                document.getElementById('cultural-significance-section').style.display = 'none';
            }
            
            // Create gallery dots if multiple images
            createGalleryDots();
            
            // Clear input fields
            document.getElementById('bid-amount').value = '';
            document.getElementById('token-amount').value = '';
            
            // Show modal
            document.getElementById('artifact-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        // Update modal image
        function updateModalImage() {
            if (!selectedArtifact || !selectedArtifact.images) return;
            
            const modalImage = document.getElementById('modal-image');
            const imageSrc = selectedArtifact.images[currentImageIndex] || '/assets/images/placeholder.jpg';
            
            modalImage.style.opacity = '0';
            setTimeout(() => {
                loadImage(modalImage, imageSrc, '/assets/images/placeholder.jpg');
                modalImage.style.opacity = '1';
            }, 200);
        }
        
        // Create gallery dots for multiple images
        function createGalleryDots() {
            const dotsContainer = document.getElementById('gallery-dots');
            if (!selectedArtifact.images || selectedArtifact.images.length <= 1) {
                dotsContainer.innerHTML = '';
                return;
            }
            
            dotsContainer.innerHTML = selectedArtifact.images.map((_, index) => 
                `<span class="gallery-dot ${index === currentImageIndex ? 'active' : ''}" 
                      onclick="changeImage(${index})"></span>`
            ).join('');
        }
        
        // Change image in gallery
        function changeImage(index) {
            currentImageIndex = index;
            updateModalImage();
            
            // Update dots
            document.querySelectorAll('.gallery-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
        }
        
        // Close modal
        function closeModal() {
            document.getElementById('artifact-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            selectedArtifact = null;
            currentImageIndex = 0;
        }
        
        // Place bid
        async function placeBid() {
            if (!userAccount) {
                showToast('Please connect your wallet first', 'error');
                return;
            }
            
            const bidInput = document.getElementById('bid-amount');
            const bidAmount = parseFloat(bidInput.value);
            const minBid = selectedArtifact.currentBid + 5;
            
            if (isNaN(bidAmount) || bidAmount < minBid) {
                showToast(`Minimum bid is ${minBid} ETH`, 'error');
                return;
            }
            
            // Disable button during transaction
            const bidButton = event.target;
            bidButton.disabled = true;
            bidButton.textContent = 'Processing...';
            
            try {
                // In production, this would call the smart contract
                // const tx = await auctionContract.methods.placeBid(selectedArtifact.id)
                //     .send({ from: userAccount, value: web3.utils.toWei(bidAmount.toString(), 'ether') });
                
                // Simulate transaction delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Update local state
                selectedArtifact.currentBid = bidAmount;
                selectedArtifact.bidCount++;
                
                showToast(`Bid of ${bidAmount} ETH placed successfully!`, 'success');
                closeModal();
                renderArtifacts();
                updateStats();
                
            } catch (error) {
                console.error('Error placing bid:', error);
                showToast('Failed to place bid. Please try again.', 'error');
            } finally {
                bidButton.disabled = false;
                bidButton.textContent = 'Place Bid';
            }
        }
        
        // Buy tokens
        async function buyTokens() {
            if (!userAccount) {
                showToast('Please connect your wallet first', 'error');
                return;
            }
            
            const tokenInput = document.getElementById('token-amount');
            const tokenAmount = parseInt(tokenInput.value);
            
            if (isNaN(tokenAmount) || tokenAmount <= 0) {
                showToast('Please enter a valid token amount', 'error');
                return;
            }
            
            if (tokenAmount > selectedArtifact.fractionalAvailable) {
                showToast('Not enough tokens available', 'error');
                return;
            }
            
            const totalCost = tokenAmount * 0.0001;
            
            // Disable button during transaction
            const buyButton = event.target;
            buyButton.disabled = true;
            buyButton.textContent = 'Processing...';
            
            try {
                // In production, this would call the smart contract
                // const tx = await erc404Contract.methods.buyTokens(selectedArtifact.id, tokenAmount)
                //     .send({ from: userAccount, value: web3.utils.toWei(totalCost.toString(), 'ether') });
                
                // Simulate transaction delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Update local state
                selectedArtifact.fractionalAvailable -= tokenAmount;
                if (!artifacts.find(a => a.id === selectedArtifact.id).tokenHolders.includes(userAccount)) {
                    selectedArtifact.tokenHolders++;
                }
                
                showToast(`Successfully purchased ${tokenAmount} SHEN tokens for ${totalCost} ETH!`, 'success');
                
                if (tokenAmount >= 10000) {
                    showToast('Congratulations! You now own enough tokens for a full NFT!', 'success');
                }
                
                closeModal();
                renderArtifacts();
                updateTokenBalance();
                
            } catch (error) {
                console.error('Error buying tokens:', error);
                showToast('Failed to purchase tokens. Please try again.', 'error');
            } finally {
                buyButton.disabled = false;
                buyButton.textContent = 'Buy Tokens';
            }
        }
        
        // Update statistics
        function updateStats() {
            document.getElementById('total-lots').textContent = artifacts.length;
            const totalBids = artifacts.reduce((sum, a) => sum + a.bidCount, 0);
            document.getElementById('total-bids').textContent = totalBids;
            const totalValue = artifacts.reduce((sum, a) => sum + a.currentBid, 0);
            document.getElementById('total-value').textContent = totalValue.toFixed(0);
        }
        
        // Get time left for auction
        function getTimeLeft(endTime) {
            const now = Date.now();
            const diff = endTime - now;
            
            if (diff <= 0) return 'Ended';
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            if (days > 0) return `${days}d ${hours}h`;
            if (hours > 0) return `${hours}h ${minutes}m`;
            return `${minutes}m`;
        }
        
        // Start timers to update time left
        function startTimers() {
            setInterval(() => {
                // Update time left in grid
                const cards = document.querySelectorAll('.artifact-card');
                cards.forEach((card, index) => {
                    const artifact = artifacts[index];
                    const timeElement = card.querySelector('.artifact-estimate:last-of-type');
                    if (timeElement && artifact) {
                        timeElement.textContent = `${artifact.bidCount} bids • ${getTimeLeft(artifact.endTime)}`;
                    }
                });
            }, 60000); // Update every minute
        }
        
        // Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Scroll functions
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function scrollToAuctions() {
            document.getElementById('auctions').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Toggle mobile menu (placeholder)
        function toggleMobileMenu() {
            showToast('Mobile menu coming soon', 'info');
        }
        
        // Modal close on outside click
        window.onclick = function(event) {
            const modal = document.getElementById('artifact-modal');
            if (event.target === modal) {
                closeModal();
            }
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && selectedArtifact) {
                closeModal();
            }
            
            // Arrow keys for image gallery
            if (selectedArtifact && selectedArtifact.images && selectedArtifact.images.length > 1) {
                if (e.key === 'ArrowLeft' && currentImageIndex > 0) {
                    changeImage(currentImageIndex - 1);
                } else if (e.key === 'ArrowRight' && currentImageIndex < selectedArtifact.images.length - 1) {
                    changeImage(currentImageIndex + 1);
                }
            }
        });
        
        // Handle resize events
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                renderArtifacts();
            }, 250);
        });
        
        // Service Worker for offline capability and better performance
        if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
            navigator.serviceWorker.register('/sw.js').catch(() => {
                // Service worker registration failed, app will still work online
            });
        }
        
        // Initialize on load
        window.addEventListener('load', init);
        
        // Cleanup on unload
        window.addEventListener('beforeunload', () => {
            if (window.ethereum) {
                window.ethereum.removeListener('accountsChanged', handleAccountsChanged);
            }
        });
    </script>
</body>
</html>
